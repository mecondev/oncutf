# Global Cursor Rules for the OnCutF Project
# (Strict & Structured Version – Option A)

These rules apply to **all Cursor agents** working in this repository.

The goal is to ensure stable, predictable, and safe behavior in a large
PyQt5 application that includes a rename engine, metadata managers,
threaded workers, UI managers, and many custom widgets.

---

## Language Separation Rule (IMPORTANT)

- The agent must **always communicate with the user in Greek**.
- The agent must **always write output artifacts in English**, including:
  - commit messages
  - code
  - comments
  - docstrings
  - filenames
  - logs
  - documentation
- Only human conversation is in Greek. Everything that belongs to the codebase or Git history must be in English.

---

## 1. Communication Rules

- **Reply to the user in Greek**, always friendly, clear, and chatty.
- **All code, docstrings, comments, log messages, and UI text must be in English.**
- Keep explanations concise but helpful.

---

## 2. Safety Rules (MANDATORY)

- **Never apply changes without explicit user approval.**
  - When proposing code edits:
    1. Present the proposed change clearly.
    2. Wait for a direct confirmation like `"Ναι"` or `"Yes"`.
    3. Only then apply the change.
- **Never run git commands** (commit, pull, push, reset, clean) unless explicitly asked.
- **Never delete comments, docstrings, or loggers** unless the user clearly asks.
- **Never restructure large parts of the codebase** without pre-approval.
- **Never create or delete files automatically** unless user confirms.

---

## 3. Project Structure Awareness

When navigating or modifying code, respect these domains:

### Core application logic (business logic)
Located in `core/`:
- `unified_rename_engine.py`
- `unified_metadata_manager.py`
- `structured_metadata_manager.py`
- `application_service.py`
- `application_context.py`
- `table_manager.py`
- `ui_manager.py`
- `status_manager.py`
- `shortcut_manager.py`
- `window_config_manager.py`
- and others

Rules:
- Keep logic modular and predictable.
- Do not mix UI code into core modules.
- Follow existing patterns for managers & services.

### Rename modules
Located in `modules/`:
- `base_module.py`
- `specified_text_module.py`
- `counter_module.py`
- `metadata_module.py`
- `name_transform_module.py`
- `text_removal_module.py`
- etc.

Rules:
- Modules generate **name fragments only**.
- They must be deterministic, pure, and isolated.
- No filesystem operations.
- No UI access.
- Implement `is_effective()` when appropriate.

### GUI / Qt widgets
Located in `widgets/` and `main_window.py`:
- custom table/tree views, delegates
- module UI components
- dialogs
- interactive header
- splash screen
- rename UI containers

Rules:
- Keep UI responsive (no blocking calls).
- Heavy operations → thread/async managers.
- Follow existing signal/slot patterns.
- Do not embed business logic inside widgets.

### Utilities
Located in `utils/`:
- validators
- path helpers
- metadata exporters
- icon loaders
- drag/drop validators
- timing helpers
- logger helpers

Rules:
- Keep utilities pure and reusable.
- Avoid adding side effects unless necessary.

---

## 4. File Change Rules

When editing or creating files, always:

- Add **type annotations**.
- Add or update **module-level docstrings**.
- Write **rich English comments** when logic is non-trivial.
- Use **stable, maintainable patterns** (avoid clever tricks).
- Follow existing structure and naming style.

When modifying multiple files:
- Propose a plan first.
- Apply changes only after approval.

---

## 5. PyQt5 / Threading / Metadata Rules

- Never block the main Qt thread.
- Heavy tasks must use:
  - `thread_pool_manager`
  - worker classes
  - async operations manager (if applicable)
- Metadata loading must always use:
  - `unified_metadata_manager`
  - `structured_metadata_manager`
- Use persistent ExifTool where available.
- Avoid deep or recursive metadata structures.

---

## 6. Testing & Development

- Tests run using `pytest`.
- Some tests require `exiftool` in PATH.
- Avoid modifying tests without user approval.
- When adding features, encourage writing/updating tests, but do not enforce unless requested.

---

## 7. Integration with `.cursor/rules/*`

The following rule files refine behavior:
- `.cursor/rules/general.md`
- `.cursor/rules/gui.md`
- `.cursor/rules/metadata.md`
- `.cursor/rules/rename_modules.md`

Agents must combine the rules in this file with those domain-specific files.

---

## 8. Golden Rule

If unsure about where code should go,
**ask the user in Greek** and propose 1–2 clean options before attempting code changes.

Always prefer:
> **predictability > cleverness**
> **maintainable structure > shortcuts**
> **user confirmation > assumptions**

